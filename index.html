/<!DOCTYPE html>
<html>
<head>
  <title>拯溺筆試練習(水上急救)</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
<style>
  body {
    font-family: Arial, sans-serif;
    text-align: center;
  }

  .container {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    margin-top: 50px;
  }

  .scoreboard-table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 20px;
  }

  .scoreboard-table th {
    background-color: #006400; /* dark green */
    font-size: 24px;
    padding: 10px;
    color: white;
  }

  .scoreboard-table td {
    font-size: 24px;
    padding: 10px;
    text-align: right;
    background-color: #f2f2f2;
  }

  .scoreboard-heading {
    font-size: 32px;
    margin-bottom: 10px;
    background-color: #006400; /* dark green */
    padding: 10px;
    color: white;
  }

  .timer-container {
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 10px;
  }

  .timer-label {
    font-size: 24px;
    margin-right: 10px;
    color: #000000; 
  }

  .timer {
    font-size: 24px;
    color: #000000; 
  }

  .score-separator {
    font-size: 24px;
    margin: 0 10px;
    color: #000000; 
  }

  .score {
    font-size: 24px;
    color: #000000; 
  }

  .question {
    font-size: 20px;
    margin-bottom: 20px;
  }

  .option {
    padding: 12px 16px;
    margin-bottom: 10px;
    border: 1px solid black;
    border-radius: 8px;
    cursor: pointer;
  }

  .option-label {
    font-size: 16px;
  }

  .correct-option {
    background-color: green;
    color: white;
  }

  .wrong-option {
    background-color: red;
    color: white;
  }

  .next-button {
    display: none;
    margin-top: 20px;
    width: 120px;
    height: 40px;
    font-size: 20px;
  }

  .redo-button {
    display: none;
    margin-top: 20px;
    width: 120px;
    height: 40px;
    font-size: 20px;
  }
</style>
</head>
<body>
  <div class="container">
    <h1 class="scoreboard-heading">水上急救</h1>
    <div class="timer-container">
      <span class="timer" id="stopwatch">22:32</span>
    </div>
    <h1 class="question" id="question-text"></h1>
    <div id="options-container"></div>
    <div id="feedback-container"></div>
    <button id="next-button" class="next-button">下一題</button>
    <button id="redo-button" class="redo-button">重設</button>
  </div>

  <script>
    const stopwatchElement = document.getElementById('stopwatch');
  let timeInSeconds = 30 * 60; // 30 minutes in seconds
  let timerInterval = null;
  window.addEventListener('load', loadQuizState);

    function updateStopwatch() {
      const minutes = Math.floor(timeInSeconds / 60);
      const seconds = timeInSeconds % 60;
      stopwatchElement.textContent = `${padZero(minutes)}:${padZero(seconds)}`;
      timeInSeconds--;
      if (timeInSeconds < 0) {
        clearInterval(timerInterval);
        handleTimeUp();
      }
    }

    function padZero(value) {
      return value.toString().padStart(2, '0');
    }

    function handleTimeUp() {
      alert('Time is up!');
    }

    // Start the stopwatch
    timerInterval = setInterval(updateStopwatch, 1000);

    const questionText = document.getElementById('question-text');
    const optionsContainer = document.getElementById('options-container');
    const feedbackContainer = document.getElementById('feedback-container');
    const nextButton = document.getElementById('next-button');
    const redoButton = document.getElementById('redo-button');

  const allQuestions = [
    {
      "question": "脊髓神經共有多少對",
      "options": [
        { "label": "A. 21對", "value": "A" },
        { "label": "B. 26對", "value": "B" },
        { "label": "C. 31對", "value": "C" },
        { "label": "D. 35對", "value": "D" }
      ],
      "correctAnswer": "C"
    },
    {
      "question": "下列哪一項能减輕蟲咬傷的痛楚及腫脹",
      "options": [
        { "label": "A.冷敷", "value": "A" },
        { "label": "B.按摩", "value": "B" },
        { "label": "C.熱敷", "value": "C" },
        { "label": "D.包紮傷處", "value": "D" }
      ],
      "correctAnswer": "A"
    },
        {
      "question": "Test",
      "options": [
        { "label": "A.冷敷", "value": "A" },
        { "label": "B.按摩", "value": "B" },
        { "label": "C.熱敷", "value": "C" },
        { "label": "D.包紮傷處", "value": "D" }
      ],
      "correctAnswer": "A"
    }
  ];

  const numRandomQuestions = 2;
  const questions = getRandomQuestions(numRandomQuestions);


    let currentQuestionIndex = 0;
    let score = 0;
    let userAnswered = false;

    function showQuestion() {
      const question = questions[currentQuestionIndex];
      questionText.textContent = question.question;
      optionsContainer.innerHTML = '';

      question.options.forEach(option => {
        const optionElement = document.createElement('div');
        optionElement.classList.add('option');
        optionElement.dataset.value = option.value;
        optionElement.addEventListener('click', handleOptionClick);

        const optionLabel = document.createElement('span');
        optionLabel.classList.add('option-label');
        optionLabel.textContent = option.label;

        optionElement.appendChild(optionLabel);
        optionsContainer.appendChild(optionElement);
      });

      if (userAnswered) {
        const selectedOption = optionsContainer.querySelector(`[data-value="${question.userAnswer}"]`);
        if (selectedOption) {
          selectedOption.classList.add('wrong-option');
        }
        const correctOption = optionsContainer.querySelector(`[data-value="${question.correctAnswer}"]`);
        if (correctOption) {
          correctOption.classList.add('correct-option');
        }
      }

      feedbackContainer.textContent = '';
      nextButton.style.display = 'none';
    }

    function handleOptionClick(event) {
      if (userAnswered) {
        return;
      }

      userAnswered = true;
      const selectedOption = event.target.closest('.option');
      const selectedValue = selectedOption.dataset.value;

      const question = questions[currentQuestionIndex];
      question.userAnswer = selectedValue;

      if (selectedValue === question.correctAnswer) {
        selectedOption.classList.add('correct-option');
        score++;
      } else {
        selectedOption.classList.add('wrong-option');
        const correctOption = optionsContainer.querySelector(`[data-value="${question.correctAnswer}"]`);
        correctOption.classList.add('correct-option');
      }

      feedbackContainer.textContent = selectedValue === question.correctAnswer ? '正確答案' : '錯誤答案';
      nextButton.style.display = 'block';
    }

    function showNextQuestion() {
      currentQuestionIndex++;
      userAnswered = false;

      if (currentQuestionIndex >= questions.length) {
        showResult();
      } else {
        showQuestion();
      }
    }

function saveQuizState() {
  const quizState = {
    currentQuestionIndex: currentQuestionIndex,
    score: score,
    userAnswers: questions.map(question => question.userAnswer)
  };
  localStorage.setItem('quizState', JSON.stringify(quizState));
}


function showResult() {
  saveQuizState();
  questionText.textContent = '測試完成';
  optionsContainer.innerHTML = '';
  feedbackContainer.textContent = `你的分數是 ${score} / ${questions.length}`;
  nextButton.style.display = 'none';
  redoButton.style.display = 'block';

  clearInterval(timerInterval); // Stop the timer
}

function loadQuizState() {
  const quizState = JSON.parse(localStorage.getItem('quizState'));

  if (quizState) {
    currentQuestionIndex = quizState.currentQuestionIndex;
    score = quizState.score;
    questions.forEach((question, index) => {
      question.userAnswer = quizState.userAnswers[index];
    });
  }
}

  function getRandomQuestions(numQuestions) {
    const shuffledQuestions = allQuestions.sort(() => Math.random() - 0.5);
    return shuffledQuestions.slice(0, numQuestions);
  }

function redoQuiz() {
  localStorage.removeItem('quizState');
  clearInterval(timerInterval);
  loadQuizState();
  currentQuestionIndex = 0;
  score = 0;
  userAnswered = false;
  showQuestion();
  redoButton.style.display = 'none';
  clearInterval(timerInterval); // Clear the previous timer interval
  timeInSeconds = 30 * 60; // Reset the timer to 30 minutes
  timerInterval = setInterval(updateStopwatch, 1000); // Start the timer again
}    

    nextButton.addEventListener('click', showNextQuestion);
    redoButton.addEventListener('click', redoQuiz);

    // Show the first question
    showQuestion();

  </script>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8814964085069203"
     crossorigin="anonymous"></script>
</body>
</html>
